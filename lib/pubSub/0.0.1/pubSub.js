define(function(require, exports, module) {function bind(t,e){var n=this,r=n.getAttr("events");if("string"!=typeof t)throw new Error("方法 bind(eventName, callback) 的参数eventName 必须为字符串");"object"!=typeof r&&(r={}),r[t]instanceof Array||(r[t]=[]),"function"==typeof e&&r[t].push(e),n.setAttr("events",r)}function unbind(t,e){var n=this,r=n.getAttr("events");if(0===arguments.length)r=null,r={},n.setAttr("events",r);else if(1===arguments.length){if("string"!=typeof t)throw new Error("方法 unbind(eventName, callback) 的参数 eventName 必须为字符串");r&&r[t]instanceof Array&&(r[t].length=0)}else{if("string"!=typeof t)throw new Error("方法 unbind(eventName, callback) 的参数 eventName 必须为字符串");if(r&&r[t]instanceof Array)if("function"==typeof e)for(var i=r[t],s=i.length-1;s>=0;s--)i[s]===e&&(i[s]=null);else r[t].length=0}return n.setAttr("events",r),n}function trigger(t){var e,n=this,r=n.getAttr("events"),i=Array.prototype.slice.apply(arguments),s=[];if(t=i.shift(),"string"!=typeof t)throw new Error("方法 trigger(eventName) 的参数eventName 必须为字符串");if(r&&r[t]instanceof Array){e=r[t];for(var a=0,o=e.length;o>a;a++)if("function"==typeof e[a]){var f=e[a].apply(n,i);if(f===!1)break}else s.push(a);for(a=s.length-1;a>=0;a--)e.splice(a,1);n.setAttr("events",r)}return n}function eachEvents(t,e){if("string"!=typeof t)throw new Error("函数 eachEvents(eventsName) 的参数 eventsName 必须为字符串");t=split(t);for(var n,r=0,i=t.length;i>r;r++)n=t[r],"function"==typeof e&&e(n)}function split(t){return t.split(SPLITTER)}var createClass=require("createClass/0.0.1/createClass"),SPLITTER=",",PubSub=createClass({methods:{bind:function(t,e){{var n=this;n.getAttr("events")}return eachEvents(t,function(t){bind.apply(n,[t,e])}),n},unbind:function(t){var e=this,n=e.getAttr("events");if(0===arguments.length)n=null,n={},e.setAttr("events",n);else{var r=Array.prototype.slice.apply(arguments);r.shift(),eachEvents(t,function(t){var n=r.slice();n.unshift(t),unbind.apply(e,n)})}return e},trigger:function(t){var e=this,n=Array.prototype.slice.apply(arguments);return 0===arguments.length?e:(t=n.shift(),eachEvents(t,function(t){var r=n.slice();r.unshift(t),trigger.apply(e,r)}),e)},on:function(t,e){var n=this;return 1===arguments.length?n.trigger(t):arguments.length>1&&n.bind(t,e),n},off:function(t,e){var n=this;return n.unbind(t,e),n},once:function(t,e){"function"==typeof e&&this.bind(t,function(){e.apply(this,arguments),this.unbind(t,arguments.callee)})}}});module.exports=PubSub;});